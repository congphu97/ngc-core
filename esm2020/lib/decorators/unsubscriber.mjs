import { Subject } from 'rxjs';
import { takeUntil } from 'rxjs/operators';
import _ from 'lodash';
export const DESTROY_CMP_SUBJECT_NAME = 'destroyed$';
export function destroyCmp(instance, destroyMethodName) {
    const destroyed$ = instance[destroyMethodName || DESTROY_CMP_SUBJECT_NAME];
    destroyed$?.next();
}
export function untilCmpDestroyed(instance, destroyMethodName) {
    // eslint-disable-next-line no-shadow, @typescript-eslint/no-shadow
    return (source) => {
        const destroyed$ = instance[destroyMethodName || DESTROY_CMP_SUBJECT_NAME] || new Subject();
        if (!destroyMethodName)
            instance[DESTROY_CMP_SUBJECT_NAME] = destroyed$;
        return source.pipe(takeUntil(destroyed$));
    };
}
export function Unsubscriber() {
    return (target) => {
        const cmpOnDestroy = target.prototype.ngOnDestroy;
        target.prototype.ngOnDestroy = function () {
            this[DESTROY_CMP_SUBJECT_NAME]?.next();
            _.isFunction(cmpOnDestroy) && cmpOnDestroy.apply(this);
        };
    };
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidW5zdWJzY3JpYmVyLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vLi4vc3JjL2xpYi9kZWNvcmF0b3JzL3Vuc3Vic2NyaWJlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsT0FBTyxFQUF3QyxNQUFNLE1BQU0sQ0FBQztBQUNyRSxPQUFPLEVBQUUsU0FBUyxFQUFFLE1BQU0sZ0JBQWdCLENBQUM7QUFDM0MsT0FBTyxDQUFDLE1BQU0sUUFBUSxDQUFDO0FBRXZCLE1BQU0sQ0FBQyxNQUFNLHdCQUF3QixHQUFXLFlBQVksQ0FBQztBQUU3RCxNQUFNLFVBQVUsVUFBVSxDQUFXLFFBQVcsRUFBRSxpQkFBMEI7SUFDM0UsTUFBTSxVQUFVLEdBQWtCLFFBQVEsQ0FBRSxpQkFBaUIsSUFBSSx3QkFBd0IsQ0FBRSxDQUFDO0lBRTVGLFVBQVUsRUFBRSxJQUFJLEVBQUUsQ0FBQztBQUNwQixDQUFDO0FBRUQsTUFBTSxVQUFVLGlCQUFpQixDQUFvQixRQUFXLEVBQUUsaUJBQTBCO0lBQzNGLG1FQUFtRTtJQUNuRSxPQUFPLENBQU0sTUFBcUIsRUFBRyxFQUFFO1FBQ3RDLE1BQU0sVUFBVSxHQUFrQixRQUFRLENBQUUsaUJBQWlCLElBQUksd0JBQXdCLENBQUUsSUFBSSxJQUFJLE9BQU8sRUFBUSxDQUFDO1FBRW5ILElBQUssQ0FBQyxpQkFBaUI7WUFBRyxRQUFRLENBQUUsd0JBQXdCLENBQUUsR0FBRyxVQUFVLENBQUM7UUFFNUUsT0FBTyxNQUFNLENBQUMsSUFBSSxDQUFFLFNBQVMsQ0FBSyxVQUFVLENBQUUsQ0FBRSxDQUFDO0lBQ2xELENBQUMsQ0FBQztBQUNILENBQUM7QUFFRCxNQUFNLFVBQVUsWUFBWTtJQUMzQixPQUFPLENBQUUsTUFBa0IsRUFBRyxFQUFFO1FBQy9CLE1BQU0sWUFBWSxHQUF3QixNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsQ0FBQztRQUV2RSxNQUFNLENBQUMsU0FBUyxDQUFDLFdBQVcsR0FBRztZQUM5QixJQUFJLENBQUUsd0JBQXdCLENBQUUsRUFBRSxJQUFJLEVBQUUsQ0FBQztZQUN6QyxDQUFDLENBQUMsVUFBVSxDQUFFLFlBQVksQ0FBRSxJQUFJLFlBQVksQ0FBQyxLQUFLLENBQUUsSUFBSSxDQUFFLENBQUM7UUFDNUQsQ0FBQyxDQUFDO0lBQ0gsQ0FBQyxDQUFDO0FBQ0gsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFN1YmplY3QsIE9ic2VydmFibGUsIE1vbm9UeXBlT3BlcmF0b3JGdW5jdGlvbiB9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHsgdGFrZVVudGlsIH0gZnJvbSAncnhqcy9vcGVyYXRvcnMnO1xuaW1wb3J0IF8gZnJvbSAnbG9kYXNoJztcblxuZXhwb3J0IGNvbnN0IERFU1RST1lfQ01QX1NVQkpFQ1RfTkFNRTogc3RyaW5nID0gJ2Rlc3Ryb3llZCQnO1xuXG5leHBvcnQgZnVuY3Rpb24gZGVzdHJveUNtcDxUID0gYW55PiggaW5zdGFuY2U6IFQsIGRlc3Ryb3lNZXRob2ROYW1lPzogc3RyaW5nICkge1xuXHRjb25zdCBkZXN0cm95ZWQkOiBTdWJqZWN0PHZvaWQ+ID0gaW5zdGFuY2VbIGRlc3Ryb3lNZXRob2ROYW1lIHx8IERFU1RST1lfQ01QX1NVQkpFQ1RfTkFNRSBdO1xuXG5cdGRlc3Ryb3llZCQ/Lm5leHQoKTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHVudGlsQ21wRGVzdHJveWVkPFQgPSBhbnksIFUgPSBhbnk+KCBpbnN0YW5jZTogVCwgZGVzdHJveU1ldGhvZE5hbWU/OiBzdHJpbmcgKTogTW9ub1R5cGVPcGVyYXRvckZ1bmN0aW9uPFU+IHtcblx0Ly8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLXNoYWRvdywgQHR5cGVzY3JpcHQtZXNsaW50L25vLXNoYWRvd1xuXHRyZXR1cm4gPFU+ICggc291cmNlOiBPYnNlcnZhYmxlPFU+ICkgPT4ge1xuXHRcdGNvbnN0IGRlc3Ryb3llZCQ6IFN1YmplY3Q8dm9pZD4gPSBpbnN0YW5jZVsgZGVzdHJveU1ldGhvZE5hbWUgfHwgREVTVFJPWV9DTVBfU1VCSkVDVF9OQU1FIF0gfHwgbmV3IFN1YmplY3Q8dm9pZD4oKTtcblxuXHRcdGlmICggIWRlc3Ryb3lNZXRob2ROYW1lICkgaW5zdGFuY2VbIERFU1RST1lfQ01QX1NVQkpFQ1RfTkFNRSBdID0gZGVzdHJveWVkJDtcblxuXHRcdHJldHVybiBzb3VyY2UucGlwZSggdGFrZVVudGlsPFU+KCBkZXN0cm95ZWQkICkgKTtcblx0fTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIFVuc3Vic2NyaWJlcigpOiBDbGFzc0RlY29yYXRvciB7XG5cdHJldHVybiAoIHRhcmdldDogKEZ1bmN0aW9uKSApID0+IHtcblx0XHRjb25zdCBjbXBPbkRlc3Ryb3k6ICgoKSA9PiB2b2lkKSB8IG51bGwgPSB0YXJnZXQucHJvdG90eXBlLm5nT25EZXN0cm95O1xuXG5cdFx0dGFyZ2V0LnByb3RvdHlwZS5uZ09uRGVzdHJveSA9IGZ1bmN0aW9uKCkge1xuXHRcdFx0dGhpc1sgREVTVFJPWV9DTVBfU1VCSkVDVF9OQU1FIF0/Lm5leHQoKTtcblx0XHRcdF8uaXNGdW5jdGlvbiggY21wT25EZXN0cm95ICkgJiYgY21wT25EZXN0cm95LmFwcGx5KCB0aGlzICk7XG5cdFx0fTtcblx0fTtcbn1cbiJdfQ==